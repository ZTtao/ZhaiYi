<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pers.zhentao.zhaiyi.MostBeautifulRuiGuNiangVote.mapper.CompetitorMapper">
    <resultMap id="BaseResultMap" type="pers.zhentao.zhaiyi.MostBeautifulRuiGuNiangVote.dto.Competitor">
        <result column="competitor_id" property="competitorId" jdbcType="INTEGER"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="number" property="number" jdbcType="INTEGER"/>
        <result column="declaration" property="declaration" jdbcType="VARCHAR"/>
        <result column="wechat_id" property="wechatId" jdbcType="VARCHAR"/>
        <result column="open_id" property="openId" jdbcType="VARCHAR"/>
        <result column="is_pass" property="isPass" jdbcType="SMALLINT"/>
        <result column="phone" property="phone" jdbcType="VARCHAR"/>
        <result column="picture_url" property="pictureUrl" jdbcType="VARCHAR"/>
        <result column="created_date" property="createdDate" jdbcType="TIMESTAMP"/>
    </resultMap>
    <sql id="queryClause">
        <if test="dto.competitorId!=0">
            and competitor_id=#{dto.competitorId}
        </if>
        <if test="dto.name!=null">
            and INSTR(name,#{dto.name})
        </if>
        <if test="dto.number!=0">
            and INSTR(number,#{dto.number})
        </if>
        <if test="dto.wechatId!=null">
            and wechat_id=#{dto.wechatId}
        </if>
        <if test="dto.openId!=null">
            and open_id=#{dto.openId}
        </if>
        <if test="dto.isPass!=null">
            and is_pass=#{dto.isPass}
        </if>
        <if test="dto.phone!=null">
            and INSTR(phone,#{dto.phone})
        </if>
    </sql>
    <select id="select" resultMap="BaseResultMap">
        select * from mbrgnv_competitor
        WHERE 1=1
        <include refid="queryClause"></include>
    </select>
    <update id="updateIsPass">
        UPDATE mbrgnv_competitor SET is_pass = IF(is_pass=0,1,0)
        <where>
            competitor_id=#{id}
        </where>
    </update>
    <insert id="insert" parameterType="pers.zhentao.zhaiyi.MostBeautifulRuiGuNiangVote.dto.Competitor">
        INSERT INTO mbrgnv_competitor(name,number,declaration,wechat_id,open_id,phone,picture_url)
        VALUES (#{dto.name},#{dto.number},#{dto.declaration},#{dto.wechatId},#{dto.openId},#{dto.phone},#{dto.pictureUrl})
    </insert>
</mapper>