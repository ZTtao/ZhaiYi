<%@page pageEncoding="UTF-8"%>
<div style="z-index: 10000;background-color:#ffffff;width: 100%;height: 150px;position: fixed;bottom: 0;left: 0px;margin: 0px;"
     class="panel panel-default">
    <button id="footer-homepage-btn"
            style="background-color:#ffffff;font-size: 40px;width: 24%;border: 0px;padding: 0px;">
        <i id="footer-homepage-icon"
           style="background: url('/resources/mbrgnv/img/icon-footer.png') no-repeat;background-size:1200px;background-position:0px 0px;width: 100px;height: 100px;display: block;margin: 0 auto;"></i>
        &#x9996;&#x9875;
    </button>
    <button id="footer-ranklist-btn"
            style="background-color:#ffffff;font-size: 40px;width: 24%;border: 0px;padding: 0px;">
        <i id="footer-ranklist-icon"
           style="background: url('/resources/mbrgnv/img/icon-footer.png') no-repeat;background-size:1200px;background-position:-112px 0px;width: 100px;height: 100px;display: block;margin: 0 auto;"></i>
        &#x6392;&#x884C;
    </button>
    <button id="footer-apply-btn" style="background-color:#ffffff;font-size: 40px;width: 24%;border: 0px;padding: 0px;">
        <i id="footer-apply-icon"
           style="background: url('/resources/mbrgnv/img/icon-footer.png') no-repeat;background-size:1200px;background-position:-210px 0px;width: 100px;height: 100px;display: block;margin: 0 auto;"></i>
        &#x62A5;&#x540D;
    </button>
    <button id="footer-explain-btn"
            style="background-color:#ffffff;font-size: 40px;width: 24%;border: 0px;padding: 0px;">
        <i id="footer-explain-icon"
           style="background: url('/resources/mbrgnv/img/icon-footer.png') no-repeat;background-size:1200px;background-position:-305px 0px;width: 100px;height: 100px;display: block;margin: 0 auto;"></i>
        &#x6D3B;&#x52A8;&#x8BF4;&#x660E;
    </button>
</div>
<div class="modal fade" id="resultModal" tabindex="-1" role="dialog" aria-labelledby="resultModalLabel">
    <div class="modal-dialog" role="document" style="width: 90%;max-width: 800px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <p style="font-size: 63px;" class="modal-title" id="resultModalLabel">请先关注&lt;瑞姑娘&gt;公众号(长按识别)</p>
            </div>
            <div class="modal-body">
                <img style="width: 100%;" src="/resources/mbrgnv/img/qrcode_rgn.jpg">
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    if (pageIndex == "homepage") {
        $("#footer-homepage-icon").css("background-position", "-407px -5px");
    } else if (pageIndex == "explain") {
        $("#footer-explain-icon").css("background-position", "-706px -5px");
    } else if (pageIndex == "rank") {
        $("#footer-ranklist-icon").css("background-position", "-511px -5px");
    } else if (pageIndex == "apply") {
        $("#footer-apply-icon").css("background-position", "-611px -5px");
    }
    $("#footer-homepage-btn").on("click", function () {
        window.location.href = "/mbrgnv?openId="+openId;
    });
    $("#footer-explain-btn").on("click", function () {
        window.location.href = "/mbrgnv/explain?openId="+openId;
    });
    $("#footer-ranklist-btn").on("click", function () {
        window.location.href = "/mbrgnv/rank?openId="+openId;
    });
    $("#footer-apply-btn").on("click", function () {
        window.location.href = "/mbrgnv/apply?openId="+openId;
    });
    function poll(competitorId) {
        $.ajax({
            url: '/mbrgnv/poll',
            type: 'post',
            data: "openId=" + openId + "&competitorId=" + competitorId,
            success: function (data) {
                if (data.success == "true") {
                    alert("投票成功");
                    if (pageIndex == "info")
                        window.location.reload();
                } else {
                    if (data.result == "2") {
                        alert("投票失败，请重试");
                        if (pageIndex == "info")
                            window.location.reload();
                    } else if(data.result == "3"){
                        alert("当天投票数已满，明天再来吧～");
                        if (pageIndex == "info")
                            window.location.reload();
                    }else if(data.result == "4"){
                        alert("投票时间已过");
                    }else if(data.result == "5"){
                        //未关注公众号
                        $("#resultModal").modal();
                    }
                }
            },
            error: function () {
                alert("投票失败，请重试");
                window.location.reload();
            }
        })
    }
</script>